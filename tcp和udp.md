此笔记来自于视频https://www.bilibili.com/video/BV1kV411j7hA?from=search&seid=1243700661523651683

### tcp 协议

### tcp 的目标

是为了在不可靠的网络信道上建立起可靠的数据传输

### tcp 的三次握手

    1.第一次握手 客户端向服务端发送一个sny包到服务端，询问能否与服务端建立连接
    2.第二次握手 服务端接收到客户端的sny包之后，向客户发送一个sny+ack 包，告诉客户端可以与自己简历连接
    3.第三次握手 客户端接收到服务端发送的sny+ack包之后，再向服务端发送一个ack包，此时客户端与服务端创建连接


    注：因为这个过程发送了三包数据 顾称为三次握手

        问题：
            为什么不是两次握手就建立tcp连接 （当服务端向客户端发送sny+ack包之后简历连接）？

        答案：
            加入使用两次握手就建立连接的话，客户端想服务端第一次发送sny包的时候，因为某些未知的原因导致，并未到达服务器，在中间某个网络节点产生了滞留，这时为了建立连接，客户端会重发sny包，第二次的sny包按照预期的规定到达客户端，客户端与服务端建立的连接，如果第一次发送的sny包这时到达服务端，这时服务端会认为客户端又建立了一个新的连接，服务端进入到等待状态，服务端认为是两个连接，而客户端以为是一个连接，造成了状态不一致，所以服务端收到第三次握手的ack包之后才建立连接就是为了避免网络信道不稳定的问题

### tcp 的四次挥手

    处于连接状态的客户端和服务端都可以发起关闭连接的请求

    假设客户端主动发起关闭请求
    1.第一次挥手 客户端向服务端发送一个fin包 告诉服务端要关闭连接，此时客户端进入到终止等待1的状态
    2.第二次挥手 服务端收到客户端发送的fin之后，服务端向客户端发送ack包，此时服务端进入到关闭等待状态，客户端进入到终止等待2的状态
    3.第三次挥手 此时服务端还可以发送未发送完的数据，客户端还可以接收数据，如果还有数据没有发送完就继续发送数据，如果数据都发送完了就直接向客户端发送一个fin包 进入到最终确认状态
    4.第四次挥手 客户端收到服务端发送的fin包之后 给服务端发送一个ack包，进入到超时等待阶段，经过超时时间后关闭连接，而服务端手ack包后 立即关闭连接


    问题：
        为什么客户端需要等待超时时间？

    答案：
        是为了保证服务端收到ack包，假如客户端发送的ack包在网络中丢失，服务端会停留在最后的确认状态，如果客户端发送完最后一包ack包后等待一段时间，服务端会重新进行第三次挥手的操作，再次向客户端发送一个fin包，客户端会重发ack包，也是为了保证在不可靠的网络中创建可靠的连接

### udp 协议

     就是将数据包装成一个数据包，从网卡发送出去

     优点：性能损耗少，资源占用少，速度快
     缺点：稳定性弱

### 对比

tcp：稳定可靠
使用场景：创书文件、发送邮件、浏览页面

    udp:速度快
        使用场景：视频通话、语音通话 等对实时性要求比较高的场景
